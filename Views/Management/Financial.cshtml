@model ChapeauHerkansing.ViewModels.Management.FinancialOverviewViewModel
@using ChapeauHerkansing.Models.Enums

@{
    ViewData["Title"] = "Financial Overview";
}

<partial name="_ManagementTabs" />

<h2 class="mb-4">Financial Overview</h2>

<form method="get" class="row g-3 mb-4">
    <div class="col-md-3">
        <label class="form-label">Period:</label>
        <select name="period" class="form-select">
            <option value="month" selected="@(Model.SelectedPeriod == "month")">Last Month</option>
            <option value="quarter" selected="@(Model.SelectedPeriod == "quarter")">Last Quarter</option>
            <option value="year" selected="@(Model.SelectedPeriod == "year")">Last Year</option>
            <option value="custom" selected="@(Model.SelectedPeriod == "custom")">Custom</option>
        </select>

    </div>
    <div class="col-md-3">
        <label class="form-label">Start Date:</label>
        <input type="date" name="startDate" class="form-control" value="@Model.StartDate.ToString("yyyy-MM-dd")" />
    </div>
    <div class="col-md-3">
        <label class="form-label">End Date:</label>
        <input type="date" name="endDate" class="form-control" value="@Model.EndDate.ToString("yyyy-MM-dd")" />
    </div>
    <div class="col-md-3 d-flex align-items-end">
        <button type="submit" class="btn btn-primary w-100">Show</button>
    </div>
</form>

<hr />

@if (Model.TotalSalesByType != null && Model.TotalSalesByType.Any())
{
    <h4>Sales Per Menu Type</h4>
    <ul class="list-group mb-3">
        @foreach (KeyValuePair<string, int> pair in Model.TotalSalesByType)
        {
            MenuType type = Enum.TryParse(pair.Key, out MenuType parsedType) ? parsedType : MenuType.Lunch;
            string label = parsedType.ToString();

            <li class="list-group-item d-flex justify-content-between">
                <span>@label</span>
                <span>@pair.Value orders</span>
            </li>
        }
    </ul>
}
else
{
    <p>No sales data available for this period.</p>
}

@if (Model.TotalIncomeByType != null && Model.TotalIncomeByType.Any())
{
    <h4>Income Per Menu Type</h4>
    <ul class="list-group mb-3">
        @foreach (KeyValuePair<string, decimal> pair in Model.TotalIncomeByType)
        {
            MenuType type = Enum.TryParse(pair.Key, out MenuType parsedType) ? parsedType : MenuType.Lunch;
            string label = parsedType.ToString();

            <li class="list-group-item d-flex justify-content-between">
                <span>@label</span>
                <span>€ @pair.Value.ToString("0.00")</span>
            </li>
        }
    </ul>
}
else
{
    <p>No income data available for this period.</p>
}

<h4>Total Tip Amount</h4>
<p class="fs-5 fw-semibold">€ @Model.TotalTipAmount.ToString("0.00")</p>
